@using AzDoBoards.Client
@using AzDoBoards.Utility
@using MudBlazor

<div class="work-item-chip @CssClass" style="@GetChipStyle()" @onclick="OnClick">
    <div class="d-flex align-center pa-2">
        <div class="work-item-svg-icon mr-2" title="@WorkItem.Name">
            @((MarkupString)WorkItemHelper.GetWorkItemTypeSvgIcon(WorkItem.Name))
        </div>
        <MudText Class="flex-grow-1">@WorkItem.Name</MudText>
        @if (ShowActions)
        {
            @ChildContent
        }
    </div>
</div>

@code {
    [Parameter] public WorkItemTypeInfo WorkItem { get; set; } = default!;
    [Parameter] public bool IsSelected { get; set; }
    [Parameter] public bool IsClickable { get; set; } = true;
    [Parameter] public bool ShowActions { get; set; }
    [Parameter] public string CssClass { get; set; } = "";
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private string GetChipStyle()
    {
        var baseColor = !string.IsNullOrEmpty(WorkItem.Color) ? WorkItem.Color : "#1976d2";
        var opacity = IsSelected ? "1" : "0.9";
        var cursor = IsClickable ? "pointer" : "default";
        
        return $"background-color: {baseColor}; color: white; margin: 4px; opacity: {opacity}; " +
               $"border-radius: 8px; min-width: 150px; max-width: 200px; cursor: {cursor}; " +
               $"transition: all 0.2s ease-in-out;";
    }
}